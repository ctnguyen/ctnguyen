%Texlive-full Version 3.141592-1.40.3 (Web2C 7.5.6)
%TexStudio Version 2.7.0

\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}

\usepackage{lmodern}
\usepackage[a4paper]{geometry}

\usepackage{hyperref}
\usepackage{enumitem}
% \usepackage{nomencl}\makenomenclature

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

\usepackage{pstricks}
\usepackage{pst-node}
\usepackage{color}
\usepackage[ddmmyyyy]{datetime} 


\newcommand{\E}{\mathbb{E}}
\newcommand{\Proba}{\mathbb{P}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\Bt}{B_t}
\newcommand{\DtT}{D(t,T)}
\newcommand{\RtT}{R(t,T)}
\newcommand{\PtT}{P(t,T)}
\newcommand{\PtS}{P(t,S)}
\newcommand{\LtT}{l(t,T)}
\newcommand{\YtT}{Y(t,T)}
\newcommand{\ftT}{f(t,T)}
\newcommand{\tautT}{\tau(t,T)}
\newcommand{\inttT}{\int_t^T}
\newcommand{\intt}{\int_0^t}
\newcommand{\FuncExp}{\text{exp}}
\newcommand{\FuncLn}{\text{ln}}
\newcommand{\Discount}[2]{e^{-\int_{#1}^{#2}r_u du} }
\newcommand{\bl}[1]{{\scshape  #1}}

\newcommand{\li}{l(\Ti,\Tii)}
\newcommand{\Ti}{T_{i}}
\newcommand{\Tii}{T_{i+1}}
\newcommand{\Talpha}{T_{\alpha}}
\newcommand{\Tbeta}{T_{\beta}}
\newcommand{\Pti}{P(t,T_{i})}
\newcommand{\Ptii}{P(t,T_{i+1})}
\newcommand{\Lti}{L(t,\Ti,\Tii)}
\newcommand{\Lit}{L_{i}(t)}
\newcommand{\ZCi}{ZC_{i}}
\newcommand{\ZCii}{ZC_{i+1}}
\newcommand{\Numi}{Num_{i}}
\newcommand{\Numii}{Num_{i+1}}

\newcommand{\todo}[1]{\begin{center}\color{red} TODO : #1\end{center}}

\begin{document}
\begin{titlepage}
%%%%%%%%%%%%%%%%%%%%%%%%%%  LOGO  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\begin{pspicture}(-7,0)(7,2)
%\psline(-7,0)(7,2)
\rput(-9,2){\href{http://www.univ-paris-diderot.fr/english/sc/site.php?bc=accueil&np=accueil&g=m}{\includegraphics[scale=1.2]{logo_p7}}}
\rput( -3.5,1){\href{hhttp://www.lunalogic.com/en/}{\includegraphics[scale=0.4]{logo_luna}}}
\rput(4,2){\href{https://masterfinance.math.univ-paris-diderot.fr/}
	    {	\begin{tabular}{l}
		\resizebox{4cm}{0.6cm}{M2MO} \\
		\resizebox{6cm}{0.5cm}{DEA Laure Elie}  
		\end{tabular}
	    }
}

\rput(3,-0.5){
\begin{tabular}{ll}
Tutors                                                                  &              \\ 
\href{mailto:revierdenord@gmail.com}{\textbf{Yuan LI} }                 &(Lunalogic)  \\
\href{mailto:scotti@math.univ-paris-diderot.fr}{\textbf{Simone SCOTTI}} &(Paris 7)  
\end{tabular}	    
}
%\psline(-7,0)(7,2)
\end{pspicture}
\end{center}



%%%%%%%%%%%%%%%%%% DOCUMENT TITLE %%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{2cm}

\begin{center}
%\resizebox{14cm}{0.7cm}{High dimensional PDE solver for multi-asset pricing option}
\resizebox{14cm}{0.8cm}{Variant of Libor Market Model}
\end{center}
%%%%%%%%%%%%%%%%%% DOCUMENT TITLE %%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\huge{ Version : \today }
\end{center}


\begin{center}
\href{mailto:chithanhnguyen.math@gmail.com}{\LARGE{\textbf{Chi Thanh NGUYEN}}}
\end{center}



\vfill
\begin{abstract}
In the internship at Lunalogic, we continu the work of ~\cite{THAI2013} and use the book  ~\cite{BRIGO2006} ~\cite{BRIGO2005}
\end{abstract}
\end{titlepage}


\tableofcontents
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{About Lunalogic}
\begin{tabular}{llll}
Position          &            Name              & Contact                        &Telephone      \\
Exec Director     & Fathia Rahmani               & fathia.rahmani@lunalogic.com   &               \\
HR   Director     & Isabelle Marouby             & isabelle.marouby@lunalogic.com &06.51.44.06.78 \\
Quant Consultant  & Yuan Li                      & revierdenord@gmail.com         &06.52.17.69.75 \\    
Tech. support     & Fastah Rahmani               & fastah.rahmani@gmail.com       &               \\ 
Bloomberg supp.   & Giulio D'Ambrosio            & gdambrosio3@bloomberg.net      &+442070733101  \\
\end{tabular}


\section{The Model lastly implemented at Lunalogic}
We explain here how are implemented the last model, calibration, test..., some critical views from the older work, what is done, what is to to, see \cite{THAI2013}.
\begin{itemize}
 \item horizon  = N
 \item Timeline $T_i$ , i = 0,1, .... N+1. Timeline size = N+2
 \item Time Fractions $\tau_i = \Tii-\Ti$, i=0,1,... N. 
 \item The Libor : $L_i = L(t,T_i,T_{i+1})$, i=0,1,... N. Number of LIBORs = N+1
\end{itemize}

\subsection{Market Information concerning Libor Model}
The bijective relation between forward Libor and zero coupon
\begin{equation}
\label{eq:libor_zc}
L_i(t) = L(t,\Ti,\Tii) = \frac{1}{\tau_i} \left[ \frac{\Pti}{\Ptii} - 1  \right]
\hspace{2cm}
{\Ptii} = \frac{\Pti}{1+ \tau_i L_i(t)}
\end{equation}
After having these informations, i.e zero-coupond prices or all Forward Libor Rate, one can compute the related swap rate starting at date $T_{\alpha}$, ends at date $T_{\beta}$
\begin{equation}
\label{eq:swap_rate}
S_{\alpha,\beta}(t) 
= 
\frac{P(t,T_{\alpha})-P(t,T_{\beta})}{\sum^{\hat{\beta}-}_{\hat{i}=\hat{\alpha}}\tau_{\hat{i}}P(t,T_{\hat{i}++})} 
=
\frac{\sum^{\beta-1}_{i=\alpha} \tau_i \Ptii }{A_{\alpha,\beta}(t)} \Lit 
\end{equation}


For the initial forward LIBOR ( which is different than the spot LIBOR )
\[
L_i(0) = L_i = \frac{1}{\tau_i} \left[ \frac{\ZCi}{\ZCii} - 1  \right] = \frac{1}{\tau_i} \left[ \frac{\Numii}{\Numi} - 1  \right]
\]
Then
\[
\left\{
\begin{array}{l}
Num_0 = 1 \\
\Numii = \Numi(\tau_i L_i +1)
\end{array}
\right.
\hspace{2cm}
\left\{
\begin{array}{l}
ZC_0 = 1 \\
\ZCii = \frac{\ZCi}{\tau_i L_i +1}
\end{array}
\right.
\]
The forward discount factor (useful in Swap configuration) is defined for a $t\leq \Talpha < T_k$
\[
\text{FP}(t,\Talpha,T_k)= \frac{P(t,T_k)}{P(t,\Talpha)}
 = \prod^{k-1}_{i=\alpha} \frac{\Ptii}{\Pti} 
 = \prod^{k-1}_{i=\alpha} \frac{1}{1+\tau_i \Lti }
\]
\subsection{Translation probability toward Libors dates}
The aim is to be able to express the $\Tii$-forward measure and its associated Brownian to the $\Ti$-forward measure and its associated measure. From the numeraire change formula, we have
\[
\frac{dQ^{\Tii}}{dQ^{\Ti}} = \frac{P(0,\Tii)}{P(0,\Ti)}\frac{\Pti}{\Ptii} = \textbf{c} (\tau_i \Lit + 1 )
\]
If we can express the right hand side as an exponential process, then we can apply the Girsanov theorem for getting the Brownian translation relation. In fact
\[
\frac{d (\textbf{c} (\tau_i \Lit + 1 )) }{\textbf{c} (\tau_i \Lit + 1 )} 
= \frac{\tau_i d\Lit }{\tau_i \Lit +1} = \frac{\tau_i \Lit s_i(t) B_i(t) }{\tau_i \Lit +1} dW^{\Tii} = \mu_i(t)dW^{\Tii}
\]
Remark that the last equation has a solution as geometric brownian motion :
\[
\textbf{c} (\tau_i \Lit + 1 ) = \text{exp} \left\{ \int_0^t \mu_i(s)dW^{\Tii}_s - \frac{1}{2}\int_0^t \mu^2_i(s)ds \right\}
\]
Plug into the probability equation, we can now apply the Girsanov theorem
\[
\frac{dQ^{\Tii}}{dQ^{\Ti}} = \text{exp} \left\{ \int_0^t \mu_i(s)dW^{\Tii}_s - \frac{1}{2}\int_0^t \mu^2_i(s)ds \right\}
\hspace{1.5cm}
dW^{\Ti} = dW^{\Tii} - \mu_i(t)dt
\]
Or in a general formula
\[
dW^{T_{k}} = dW^{T_{k+1}} - \frac{\tau_k L_k(t)}{\tau_k L_k(t) +1}  s_k(t) B_k(t) dt
\]

\section{The implemented model}
\section{Calibration}
This section explain how process the calibration algorithm in our LMM Model, what are input data, what are ouputs, how to test and say that our calibration is good. Firstly, we will explain what market data we need and how to retreive them. We then explain the market data issu and how to resolv this by our algorighm with a set of numerical techniques (interpolation, solver ...). At the end, we explain how we test our algorithm before using real market data, and how is tested with the real market data.   
\subsection{Bloomberg and Market Data}
\paragraph{} The first step to do with the calibration is to retreive market information. At Lunalogic RD team, we have a Bloomberg terminal and all of our data comes from this. We explain here how we retreive data with Bloomberg. In a general way, a full yield curve for horizon 50YR does not exist. One has to use quoted instruments and AOA formula, interpolation tools to fully build the interest rate curve. These instruments frequently used are
\begin{itemize}
 \item Quotation from \bl{euribor}, used for short horizon
 \item \bl{fra}, used for midle horizon
 \item Vanilla Interest rate Swap, used for long horizon
\end{itemize}
There exist many method to build interest rate curve, that we will not focus here. We suppose this curve is already built. In reality, Bloomberg propose tools to build this curve, that one can take a look at ~\cite{BL2012} or use the bloomberg tool \bl{icvs} (Swap Curve Builder).
\paragraph{} Note that all of our study are european-based. So when going to Bloomberg, we choose \bl{eur} currency, the fixed/float tenor are only choosen by 6M/1YR as standard vanilla european swap configuration. Two main data we need for the calibration are Initial Libor curve and the Black Volatility of ATM Swaption matrix.   
\paragraph{Initial Libor} is calculated from a zerocoupond set, which is available from Bloomberg (not directly). In Bloomberg terminal, we use 
\begin{center}
\bl{icvs} $\longrightarrow$ \bl{14) eur} $\longrightarrow$ \bl{21) Stripped Curve} $\longrightarrow$  \bl{Export to Excel} 
\end{center}
That give the discount curve for 50YR horizon. After getting this curve, we interpolate linearly at dates multiple of 6MO, and eliminate all elements that are not at date multiple of 6MO. Values from this curve are used as discount factors, in equations \ref{eq:libor_zc}, they are $P(0,T_{i})$, and we can have every $\L(0,T_{i},T_{i+1})$ from this. 
\paragraph{Swaption ATM Black's Vol and skew} is available from Bloomberg by ticker \bl{vcub}. After going into this page, user have to choose the right currency, the right tenor type (6M for european swaps), then refresh information. One can get Black's Vol quote for ATM swaptions, OTM or ITM swaptions and the correspondant strikes matrix by giving the moneyness information. We get the derivative skew matrix by finite difference method
\[
\textbf{derivative}(skew) = \frac{quote (\textbf{ATM+5bp}) - quote(\textbf{ATM-5bp}) }{\textbf{10bp}}
\]
The post treatment is similar as Libor quotes, we eliminate all experities that are not multiple of 1YR. Note the difference is that for swaptions quote, we only use dates multiple of 1YR. 
\paragraph{Data check}
Before using the data, we always check if the data is coherent, i.e Libor quotes is coherent with swaptions. Thanks to analytical swap rate formula \ref{eq:swap_rate} and the Libor quotes, we recompute our swap rate matrix, and compare with the ATM swaptions strike quote. The ideal case has to match exactly the same values. But in reality, there are a difference about 1\%-2\%, that is negligible and we accept this difference since we didn't send time to rigorously build our yield curve.    
\subsection{Calibration algorithm}
\paragraph{Generality on volatility data structure}
explain here the issues of missing data, the choice of swaptions instead of caplet. HG vol, nodes feature on gMatrix, interpolation. How abcd can be calibrated, how gMatrix is calibrated after. How virtual test is build.
\paragraph{Global}
\paragraph{Local}
\paragraph{Regularized global}

\subsection{Exact virtual test}
\subsection{Regularized virtual test}
\subsection{Calibration with real data - results}
Calibrating abcd before (hMatrix). Then calibrating g. Result benchmark analyse : Time computing in relation to horizon. Results stability with many different dates
\paragraph{Exact calibration}

\subsection{Approximation Swaption Black Vol by Rebonato formula}
The swap rate is computed by \footnote{The iteration through indices $\hat{i}$ and $i$ is different when the swap settlement dates are different for fixed legs and floatting legs.$\hat{i}$ iterate through fixed legs while $i$ iterate through floatting legs. Their steps can be different depending on Fixed/Float Tenor configuration}
\[
S_{\alpha,\beta}(t) 
= 
\frac{P(t,T_{\alpha})-P(t,T_{\beta})}{\sum^{\hat{\beta}-}_{\hat{i}=\hat{\alpha}}\tau_{\hat{i}}P(t,T_{\hat{i}++})} 
=
\frac{\sum^{\beta-1}_{i=\alpha} \tau_i \Ptii }{A_{\alpha,\beta}(t)} \Lit 
\]
Where 
\subsection{Calibration deterministic volatilities}
Our LMM model firstly implemented use the \textit{HGVolatility} , i.e volatilities for each LIBOR $L_i(t)$ are piecewise constant functions $\sigma_i(t)=g_i(t)h_i(t)$, where $h_i(t)$ and $g_i(t)$ are also piecewiese constant. Since they are piecewise constant, we can store these parameters in two lower triangular matrices ~\footnote{ Because $h_i(t)$ and $g_i(t)$ are volatilities of $L_i(t)=L(t,T_i,T_{i+1}) $, they are 'dead' after time $t \geq T_i$. That's why our volatility matrices are lower triangular}
\[
\left\{
\begin{array}{l}
g_{ij}= g_i(T_j) \\
h_{ij}= h_i(T_j)
\end{array}
\right.
\hspace{0.5cm}
i \geq j
\hspace{2cm}
\left\{
\begin{array}{l}
g_{0j}=g_{i0}=0 \\
h_{0j}=h_{i0}=0
\end{array}
\right.
\hspace{0.5cm}
\forall i,j
\]

\begin{center}
\begin{pspicture}(-7,-3)(7,4)
%% Reference for Picture
%\psline[linewidth=0.1pt,linecolor=gray](-7,-3)(7,4)
%\rput(-6,-3){(-6,-3)}\rput(-1,2){(-1,2)}
%\rput(2,-3){(2,-3)}\rput(7,2){(7,2)}\rput(0,0){(0,0)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Draw for Swaption matrix
\psgrid[subgriddiv=1,gridcolor=gray,griddots=10,gridlabels=0](-6,-3)(-1,2)                 % set grid for Swaptions matrix
\rput(-5,2.3){$1^{YR}$}\rput(-4,2.3){$2^{YR}$}\rput(-3,2.3){$3^{YR}$}\rput(-2,2.3){$4^{YR}$}\rput(-1,2.3){$5^{YR}$} % set horizontal label for Swaption matrix
\rput(-6.5,1){$1_{YR}$}\rput(-6.5,0){$2_{YR}$}\rput(-6.5,-1){$3_{YR}$}\rput(-6.5,-2){$4_{YR}$}\rput(-6.5,-3){$5_{YR}$} % set vertibal label for Swaption matrix
\psset{linecolor=red} % set points for swaption matrix
%\qdisk(-5,1){3pt}\qdisk(-4,1){3pt}\qdisk(-3,1){3pt}\qdisk(-2,1){3pt}
%\qdisk(-5,0){3pt}\qdisk(-4,0){3pt}\qdisk(-3,0){3pt}
%\qdisk(-5,-1){3pt}\qdisk(-4,-1){3pt}\qdisk(-5,-2){3pt}
\psdots[dotstyle=*,dotscale=2](-5,1)(-4,1)(-3,1)(-2,1)(-5,0)(-4,0)(-3,0)(-5,-1)(-4,-1)(-5,-2)
\psset{linecolor=black}
\rput(-5.5,3){$\scriptstyle\text{nbSwap} = \frac{1}{2}(\text{nbYR}-1)\text{nbYR}=10 $}
%%%%%% draw the dependance zone for Swaption 3YRx2YR
%\pspolygon[linearc=.2,fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.1pt,hatchsep=1pt,linestyle=none](-4.5,-0.5)(-3.5,-0.5)(-3.5,-1.5)(-4.5,-1.5)
\pscircle[linearc=.2,fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.1pt,hatchsep=1pt,linestyle=none](-4,-1){0.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Draw for Vol piece wise matrix
\psgrid[gridwidth=0.01pt,gridcolor=lightgray,subgriddiv=2,subgridwidth=0.1pt,subgridcolor=lightgray,gridlabels=0](2,-3)(7,2)          % set grid for vol matrix
%% set horizon label for vol matrix
\rput(2,2.1){$\scriptstyle{T_0}$}\rput(2.5,2.1){$\scriptstyle{T_1}$}
\rput(3,2.1){$\scriptstyle{T_2}$}\rput(3.5,2.1){$\scriptstyle{T_3}$}
\rput(4,2.1){$\scriptstyle{T_4}$}\rput(4.5,2.1){$\scriptstyle{T_5}$}
\rput(5,2.1){$\scriptstyle{T_6}$}\rput(5.5,2.1){$\scriptstyle{T_7}$}
\rput(6,2.1){$\scriptstyle{T_8}$}\rput(6.5,2.1){$\scriptstyle{T_9}$}
\rput(7,2.1){$\scriptstyle{T_{10}}$} 
%% set vertical label for vol matrix
\rput(1.5,1){$g_2(t)$}\rput(1.5,0){$g_4(t)$}\rput(1.5,-1){$g_6(t)$}\rput(1.5,-2){$g_8(t)$}\rput(1.5,-3){$g_{10}(t)$}     
%%
%%%%%% set points for calibrating vol
{%%
\psset{linecolor=blue} 
\psdots[dotstyle=square*,dotscale=1.5](3,0.5)(3,-0.5)(4,-0.5)(3,-1.5)(4,-1.5)(5,-1.5)(3,-2.5)(4,-2.5)(5,-2.5)(6,-2.5)
}%%
%%%%%% draw line for piecewise constant vol points
\psset{linewidth=1.2pt}
\qline(2.5,1.5)(2.1,1.5) %
\qline(2.5,1)(2.1,1)\qline(3,1)(2.6,1) %
\qline(2.5,0.5)(2.1,0.5)\qline(3,0.5)(2.6,0.5)\qline(3.5,0.5)(3.1,0.5) %
\qline(2.5,0)(2.1,0)\qline(3,0)(2.6,0)\qline(3.5,0)(3.1,0)\qline(4,0)(3.6,0) %
\qline(2.5,-0.5)(2.1,-0.5)\qline(3,-0.5)(2.6,-0.5)\qline(3.5,-0.5)(3.1,-0.5)\qline(4,-0.5)(3.6,-0.5)\qline(4.5,-0.5)(4.1,-0.5) %
\qline(2.5,-1)(2.1,-1)\qline(3,-1)(2.6,-1)\qline(3.5,-1)(3.1,-1)\qline(4,-1)(3.6,-1)\qline(4.5,-1)(4.1,-1)\qline(5,-1)(4.6,-1) %
\qline(2.5,-1.5)(2.1,-1.5)\qline(3,-1.5)(2.6,-1.5)\qline(3.5,-1.5)(3.1,-1.5)\qline(4,-1.5)(3.6,-1.5)\qline(4.5,-1.5)(4.1,-1.5)\qline(5,-1.5)(4.6,-1.5)\qline(5.5,-1.5)(5.1,-1.5) %
\qline(2.5,-2)(2.1,-2)\qline(3,-2)(2.6,-2)\qline(3.5,-2)(3.1,-2)\qline(4,-2)(3.6,-2)\qline(4.5,-2)(4.1,-2)\qline(5,-2)(4.6,-2)\qline(5.5,-2)(5.1,-2)\qline(6,-2)(5.6,-2) %
\qline(2.5,-2.5)(2.1,-2.5)\qline(3,-2.5)(2.6,-2.5)\qline(3.5,-2.5)(3.1,-2.5)\qline(4,-2.5)(3.6,-2.5)\qline(4.5,-2.5)(4.1,-2.5)\qline(5,-2.5)(4.6,-2.5)\qline(5.5,-2.5)(5.1,-2.5)\qline(6,-2.5)(5.6,-2.5)\qline(6.5,-2.5)(6.1,-2.5) %
\qline(2.5,-3)(2.1,-3)\qline(3,-3)(2.6,-3)\qline(3.5,-3)(3.1,-3)\qline(4,-3)(3.6,-3)\qline(4.5,-3)(4.1,-3)\qline(5,-3)(4.6,-3)\qline(5.5,-3)(5.1,-3)\qline(6,-3)(5.6,-3)\qline(6.5,-3)(6.1,-3)\qline(7,-3)(6.6,-3) %
%%%%%% draw line for piecewise constant vol points
\rput(5.5,3){$\scriptstyle\text{nbParam} = \frac{1}{2}(\text{nbLBR}-1)\text{nbLBR}=55 $}
%%%%%% draw the dependance zone for Swaption 3YRx2YR
{
\pspolygon[linearc=.2,fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.1pt,hatchsep=1pt,linestyle=none](2.35,-0.85)(5.15,-0.85)(5.15,-2.65)(2.35,-2.65)
}
\end{pspicture}
\end{center}
\paragraph{} When calibrating using Implied Swaption Volatilities quoted on the market, a problem arise if swaptions has different configuration of fixed tenor and float tenor. See from the figure example, on an horizon 5 year, with float/fixed tenor are 6M/1YR, we have only 10 swaption's data from the market, while the model has 55 parameters. The excessive number of parameters lead to infinity of solutions. Then we use a special calibration's process to avoid this problem. The idea is to choose sparsely some parameters in the volatility matrix, in the way that there are the same number of parameters to be calibrated than the number of swaption's data. After every calibration step ( minimization iteration ) an interpolation process are launched in order to taking in acount for the whole matrix.
\paragraph{} The idea of choosen sparse parameters are intuitive. We look in detail for each swaptions, what are dependant Libor, then we deduces the dependant parameters. For example on the horizon of 5YR, with float/fixed tenor 6M/1YR, the swaption 3YRx2YR depend to libors $L_6,L_7,L_8,L_9$. Since the swaption's maturity is 3YR=$T_6$, the swaption depend only to parameters anterior to time $T_6$, i.e $g_{ij, 6\leq i\leq 9,1\leq j\leq6}$. From this full dependant set of parameters, we choose only $g_{62},g_{64},g_{66},g_{82},g_{84},g_{86}$ for calibration. In general, we choose parameters by jumping indices step fixed tenor/float tenor. An explicite example of swaptions 1YR/6M and parameter's dependance for horizon 4YR are described in the table
\begin{center}
\begin{tabular}{||c||l|l|l|}
\hline
Swaption & Libor Dep.   & Full Vol Dep. & Sparse Vol Dep. \\
\hline
1YRx1YR  & $L_2, L_3$   & $g_{ij, 2\leq i\leq 3,1\leq j\leq2}$& $g_{22}$\\
\hline
1YRx2YR  & $L_2,...L_5$ & $g_{ij, 2\leq i\leq 5,1\leq j\leq2}$& $g_{22},g_{42}$ \\
\hline
1YRx3YR  & $L_2,...L_7$ & $g_{ij, 2\leq i\leq 7,1\leq j\leq2}$& $g_{22},g_{42},g_{62}$ \\
\hline
2YRx1YR  & $L_4, L_5$   & $g_{ij, 4\leq i\leq 5,1\leq j\leq4}$& $g_{42},g_{44}$ \\
\hline
2YRx2YR  & $L_4,...L_7$ & $g_{ij, 4\leq i\leq 7,1\leq j\leq4}$& $g_{42},g_{44},g_{62},g_{64}$\\
\hline
3YRx1YR  & $L_6, L_7$   & $g_{ij, 6\leq i\leq 7,1\leq j\leq6}$& $g_{62},g_{64},g_{66}$ \\
\hline
\end{tabular} 
\end{center}
\paragraph{Interpolation - Extrapolation volatility matrix}\mbox{}\\
Assuming we've successed to sparsely choose parameters and calibrated. Then these parameters form a 'triangle' in the volatility matrix. One can interpolate all values in its interior and extrapolate the exterior of this triangle.
\begin{center}
\begin{pspicture}(-7,-3)(7,4)
%% Reference for Picture
%\psline[linewidth=0.1pt,linecolor=gray](-7,-3)(7,4)
\rput(-6,-3){(-6,-3)}\rput(-1,2){(-1,2)}
\rput(2,-3){(2,-3)}\rput(7,2){(7,2)}\rput(0,0){(0,0)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Draw for Global Calibrate and Interpolate
\psgrid[gridwidth=0.01pt,gridcolor=lightgray,subgriddiv=2,subgridwidth=0.01pt,subgridcolor=lightgray,gridlabels=0](-6,-3)(-1,2)          % set grid for vol matrix
%% set horizon label for vol matrix
\rput(-6,2.1){$\scriptstyle{T_0}$}\rput(-5.5,2.1){$\scriptstyle{T_1}$}
\rput(-5,2.1){$\scriptstyle{T_2}$}\rput(-4.5,2.1){$\scriptstyle{T_3}$}
\rput(-4,2.1){$\scriptstyle{T_4}$}\rput(-3.5,2.1){$\scriptstyle{T_5}$}
\rput(-3,2.1){$\scriptstyle{T_6}$}\rput(-2.5,2.1){$\scriptstyle{T_7}$}
\rput(-2,2.1){$\scriptstyle{T_8}$}\rput(-1.5,2.1){$\scriptstyle{T_9}$}
\rput(-1,2.1){$\scriptstyle{T_{10}}$} 
%%
%%%%%%% set points for calibrating vol
{\psset{linecolor=blue} 
\psdots[dotstyle=square*,dotscale=1.5](-5,0.5)(-5,-0.5)(-4,-0.5)(-5,-1.5)(-4,-1.5)(-3,-1.5)(-5,-2.5)(-4,-2.5)(-3,-2.5)(-2,-2.5)
}%%%%%%
%%
%%%%%%% set interpolated points
{\psset{dotsize=3pt} 
\psdots[dotstyle=pentagon*](-5,0)(-5,-1)(-5,-2)
\psdots[dotstyle=pentagon*](-4.5,0)(-4.5,-0.5)(-4.5,-1)(-4.5,-1.5)(-4.5,-2)(-4.5,-2.5)
\psdots[dotstyle=pentagon*](-4,-1)(-4,-2)
\psdots[dotstyle=pentagon*](-3.5,-1)(-3.5,-1.5)(-3.5,-2)(-3.5,-2.5)
\psdots[dotstyle=pentagon*](-3,-2)(-2.5,-2)(-2.5,-2.5)
}%%%%%%
%%
%% set the interpolation zone
\pspolygon[fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.01pt,hatchsep=1pt,linestyle=none](-5,0.5)(-5,-2.5)(-2,-2.5)
%%
%% set the extrapolate zone
\pspolygon[fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.01pt,hatchsep=4pt,hatchangle=20,linestyle=none](-5.5,1.5)(-5,1)(-5,-2)(-2,-2)(-1,-3)(-5.5,-3)
%%
%% Set extrapolation arrows
{%%%%
\psset{linewidth=0.1pt}
\psline{->}(-5,1)(-5.5,1.5)\psline{->}(-5,1)(-5.5,1)
\psline{->}(-5,0.5)(-5.5,0.5)\psline{->}(-5,0)(-5.5,0)\psline{->}(-5,-0.5)(-5.5,-0.5)\psline{->}(-5,-1)(-5.5,-1)\psline{->}(-5,-1.5)(-5.5,-1.5)
\psline{->}(-5,-2)(-5.5,-2)\psline{->}(-5,-2)(-5.5,-2.5)\psline{->}(-5,-2)(-5.5,-3)\psline{->}(-5,-2)(-5,-3)\psline{->}(-5,-2)(-4.5,-3)\psline{->}(-5,-2)(-4,-3)
\psline{->}(-4.5,-2)(-3.5,-3)\psline{->}(-4,-2)(-3,-3)\psline{->}(-3.5,-2)(-2.5,-3)\psline{->}(-3,-2)(-2,-3)\psline{->}(-2.5,-2)(-1.5,-3)\psline{->}(-2,-2)(-1,-3)
}%%%% Set extrapolation arrows
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Draw for local Calibrate and Interpolate
\psgrid[gridwidth=0.01pt,gridcolor=lightgray,subgriddiv=2,subgridwidth=0.01pt,subgridcolor=lightgray,gridlabels=0](2,-3)(7,2)          % set grid for vol matrix
%%
%% set horizon label for vol matrix
\rput(2,2.1){$\scriptstyle{T_0}$}\rput(2.5,2.1){$\scriptstyle{T_1}$}
\rput(3,2.1){$\scriptstyle{T_2}$}\rput(3.5,2.1){$\scriptstyle{T_3}$}
\rput(4,2.1){$\scriptstyle{T_4}$}\rput(4.5,2.1){$\scriptstyle{T_5}$}
\rput(5,2.1){$\scriptstyle{T_6}$}\rput(5.5,2.1){$\scriptstyle{T_7}$}
\rput(6,2.1){$\scriptstyle{T_8}$}\rput(6.5,2.1){$\scriptstyle{T_9}$}
\rput(7,2.1){$\scriptstyle{T_{10}}$} 
%%
%% set points for calibrating vol
{%%%%
\psset{linecolor=blue} 
\psdots[dotstyle=square*,dotscale=1.5](4,-0.5)(4,-1.5)(4,-2.5)
}%%%% set points for calibrating vol
%%
%%%%%%% set interpolated points
{\psset{dotsize=3pt} 
\psdots[dotstyle=pentagon*](3.5,0)(3.5,-0.5)(3.5,-1)(3.5,-1.5)(3.5,-2)(3.5,-2.5)
\psdots[dotstyle=pentagon*](4,-1)(4,-2)
}%%%%%%
%%
%% set the interpolation zone
\pspolygon[fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.01pt,hatchsep=1pt,linestyle=none](3,0.5)(4,-0.5)(4,-2.5)(3,-2.5)
%%
%% set the extrapolate zone
\pspolygon[fillstyle=crosshatch,hatchcolor=gray,hatchwidth=0.03pt,hatchsep=3pt,hatchangle=30,linestyle=none](2.5,1.5)(3,1)(3,-2)(4,-3)(2.5,-3)
%%
%% Set extrapolation arrows
{%%%%
\psset{linewidth=0.1pt}
%\psline{->}(3,1)(2.5,1.5)\psline{->}(3,0.5)(2.5,1)\psline{->}(3,0)(2.5,0.5)
%\psline{->}(3,-0.5)(2.5,0)\psline{->}(3,-1)(2.5,-0.5)\psline{->}(3,-1.5)(2.5,-1)\psline{->}(3,-2)(2.5,-1.5)
%\psline{->}(3,-2)(2.5,-2)\psline{->}(3,-2)(2.5,-2.5)\psline{->}(3,-2)(2.5,-3)\psline{->}(3,-2)(3,-3)\psline{->}(3,-2)(3.5,-3)\psline{->}(3,-2)(4,-3)
\psline{->}(3.5,-2)(4.5,-3)\psline{->}(4,-2)(5,-3)
}%%%% Set extrapolation arrows
\end{pspicture}
\end{center}


\section{Tests and validations}
Back testing, forward testing, validation. critical view points.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Appendices}
\appendix
Some apprendices are to be added by lecture of the book ~\cite{BRIGO2006}
\subsection{Generalities about interest rate}
\begin{itemize}
 \item Zero-coupon curves, interest rate curve. When talking about curve, its is function of maturity $T$. When talking about the present time $t$, it is about process, zero-coupon process, interest rate process.
 \item Interest rate are quoted, zero-coupon are deduced from interest rate in a consistent way.
\end{itemize}
{\color{red}IMPORTANT NOTE : Concerning multiperiod product as Swaps, Caps, Floors ... there are a dangeruous difference definitions of time increment between different sources. For example ~\cite{THAI2013} defined $L_i=L(T_i,T_{i+1})$ while ~\cite{BRIGO2006} defines $L_i=L(T_{i-1},T_i)$}
\paragraph{Money-market account (riskless asset)}
\[
d\Bt=r_t \Bt dt \hspace{1cm} B(0)=1 \hspace{1cm} B_t = \intt r_s ds
\hspace{1cm}
\left\{
\begin{array}{r l}
\Bt &\text{: Money market} \\
r_t &\text{: Instantaneous rate} 
\end{array}
\right.
\]
\paragraph{Stochastic discount factor} 
\[
D(t,T) = \FuncExp\left( -\inttT r_s ds \right)
\]
Note that $D(t,T)$ is the present value of future amount currency, while $\PtT$ zero-coupon is a contract value. $D(t,T)=\PtT$ when $r_t$ is determinist.
\paragraph{Spot Interest Rate}~\footnote{The time to maturity $\tautT$ denote the day-count convention between $t$ and $T$. The simplest case $\tautT=T-t$. see~\cite{PICARDO2014} }\\
Continuously-compounded 
\[
R(t,T) = -\frac{\FuncLn\PtT }{\tautT}
\hspace{1.5cm}
e^{\RtT\tautT}\PtT = 1
\hspace{1.5cm}
\PtT = e^{-\RtT\tautT}
\]
Simply-compounded ~\footnote{This quantity is related to LIBOR, when time to maturity is lesser than one year} 
\[
\LtT = \frac{1-\PtT}{\tautT\PtT}
\hspace{0.7 cm}
\PtT(1+\LtT\tautT)=1
\hspace{0.7cm}
\PtT = \frac{1}{1+\LtT\tautT}
\]
Annually-compounded
\[
\YtT = \frac{1}{\PtT^{1/\tautT}} -1
\hspace{0.8cm}
\PtT(1+\YtT)^{\tautT} = 1
\hspace{0.8cm}
\PtT = \frac{1}{(1+\YtT)^{\tautT}}
\]

\paragraph{Zero-coupon curve / Yield curve / term structure of interest rate}
\[
\text{graphic of}
\hspace{2cm}
T \longmapsto
\left\{
\begin{array}{lll}
\LtT  &  t < T \leq t+1 & \text{Simply compounded} \\
\YtT  &  t+1 < T        & \text{Annually compounded} 
\end{array}
\right.
\]
Yield curve in a general way is the graph of $T \longmapsto \RtT$.
\todo{read about behavior of this curve (inverted at behavior at the begining)}
\paragraph{Zero-bond curve / term structure of discount factors}
\[
\text{Graphic of }
\hspace{2cm}
T \longmapsto \PtT
\hspace{1cm}
,t<T
\]
Note that zero-bond curve is less informative than the zero-coupon curve.
\paragraph{Forward interest rate} is the fair value of strike $K$ that make the contract \textbf{FRA} worth zero at time $t<T<S$  
\[
\text{Simply-compounded}
\hspace{2cm}
F(t,T,S) = \frac{1}{ \tau_{(S,T)} }\left( \frac{\PtT}{\PtS} - 1 \right)
\hspace{1cm}
,t<T<S
\]
Instantanuous forward interest rate ~\footnote{This fundamental quantity is related HJM model}
\[
\ftT = \lim_{S\rightarrow T^+} F(t,T,S) = -\frac{\partial \FuncLn\PtT}{\partial T}
\hspace{2cm}
\PtT = \FuncExp\left( -\inttT f(t,u)du \right)
\]

\paragraph{Swap} is a contract helping to convert fixed rate flow into floating rate flow and vice versa. 
\[
\left\{
\begin{array}{l}
T_{\alpha},T_{\alpha+1},...T_{\beta} \\
\tau_i = \tau(T_i,T_{i+1})           \\
L_i    = L(T_i,T_{i+1})
\end{array}
\right.
\hspace{2cm}
\begin{array}{l}
\text{Nominal $N$, paements at dates $T_i$,  } i=\alpha+1,...,\beta \\
\text{ - For fixed legs    } N\tau_{i-1}K  \\
\text{ - For floating legs } N\tau_{i-1}L_{i-1}  
\end{array}
\]
The \textbf{Payer IRS (PFS)} receive the floatting legs, pays the fixed legs, while the \textbf{Receiver IRS (RFS)} receive the fixed legs and pays the floatting legs.s. The \textbf{Forward Swap Rate} is the value of strike $K$ that make the swap contract worth zero at time $t$
\[
S_{\alpha,\beta}(t) = \frac{P(t,T_{\alpha})-P(t,T_{\beta})}{\sum^{\beta}_{i=\alpha+1}\tau_{i-1}P(t,T_i)} 
\]
\paragraph{Caps / Floors}  
\[
\left\{
\begin{array}{l}
T_{\alpha},T_{\alpha+1},...T_{\beta} \\
\tau_i = \tau(T_i,T_{i+1})           \\
L_i    = L(T_i,T_{i+1})
\end{array}
\right.
\hspace{2cm}
\begin{array}{l}  
\text{Nominal $N$, payments at dates $T_i$,  } i=\alpha+1,...,\beta   \\
\text{ - For Caps    } N\tau_{i-1}(L_{i-1}-K)^+ \hspace{1.2 cm}\text{(caplet)}              \\
\text{ - For Floors  } N\tau_{i-1}(K-L_{i-1})^+ \hspace{1cm}\text{(floorlet)}
\end{array}
\]
The simpliest idea of pricing Caps and Floors to decompose into Caplets and Floorlets, then use the model descibing the forward price's dynamic instead of underlying asset. The \textbf{Black Model} is well explained in ~\cite{MAREK2009}ch3.4.


\paragraph{Swaption}
\todo{Black Formula for pricing Caps, Floors, Swaptions}  


relation between monney market account, zerocoupon, spot rate, short rate, forward rate , swaps, caps, floor, swaptions... 
\subsection{Forward price, change of numeraire, Forward measure}
\paragraph{Numeraire change}
\begin{itemize}[label={--}]
 \item If $X$ a tradable asset, $N^1$ a numeraire associated to a martingale measure $\Proba^{N^1}$, i.e 
 \[
 \frac{X_t}{N^1_t} = \E^{N^1}\left\{ \frac{X_T}{N^1_T}| \mathcal{F}_t \right\}
 \]
 Then for an arbitrary other numeraire $N^2$, we can define an other martingale measure $\Proba^{N^2}$ with the new numeraire
 \[
 \frac{d\Proba^{N^2}}{d\Proba^{N^1}}=\frac{N^1_0}{N^2_0}\frac{N^2_T}{N^1_T}
 \hspace{3cm}
 \frac{X_t}{N^2_t} = \E^{N^2}\left\{ \frac{X_T}{N^2_T}| \mathcal{F}_t \right\}
 \]
 \item The price of any atteinable contigent claim $h_T$ is invariant by change of numeraire :
 \[
 \pi_t(h_T) = N^1_t \E^{N^1}\left\{ \frac{h_T}{N^1_T}| \mathcal{F}_t \right\} = N^2_t\E^{N^2}\left\{ \frac{h_T}{N^2_T}| \mathcal{F}_t \right\}
 \]
 \item Change of numeraire toolkit ~\cite{BRIGO2006}2.3 Fact Three explain relation between new drift and old drift when changing numeraire.
\end{itemize}

\paragraph{T-forward measure} is the martingale measure $\Proba^{T}$ using zero-coupond bond $\PtT$ as numeraire. Under this probability~\footnote{The first equallity explain relation betweent discount factor and zero-coupon, which sometimes involves confusion \[\pi_t(h_T)=\E^{*}[e^{-\int^T_t r_udu}h_T|\F_t]= \PtT\E^{T}[h_T|\F_t]\]}
\[
\pi_t(h_T)=\PtT\E^{T}[h_T|\F_t]
\hspace{1cm}
F(t,S,T)=\E^{T}[L(S,T)|\F_t]
\hspace{1cm}
f(t,T)=\E^{T}[r_T|\F_t]
\]
\paragraph{Deferred payoff}
\[
\pi_t(H_{\tau})=\E[\Discount{t}{T}H_{\tau}|\F_t] = \E[\Discount{t}{\tau}P(\tau,T)H_{\tau}|\F_t]
\hspace{1.5cm}
t<\tau<T
\]
\paragraph{Pricing}
\[
\left\{
\begin{array}{l}
\textbf{Caps}\rightarrow\textbf{Caplets}\rightarrow\textbf{Deffered payoff} \rightarrow \textbf{Put Zerocoupon} \\
\textbf{Floors}\rightarrow\textbf{Floorlets}\rightarrow\textbf{Deffered payoff} \rightarrow \textbf{Call Zerocoupon}
\end{array}
\right.
\]



Definitions of forward price, forward measure, change of numeraire. Pricing Caps, Floors, Swap?, Swaption?

\subsection{HJM Framework}
\subsection{Correlated Brownian motion, volatility}
\subsection{LIBOR Market Model}
Libor model divided into two important part, one for pricing caps, floors markets, other for swaptions. The first is easier, one simply divide caps, floors into caplets and floorlets and apply Black's formula. The second can not do so, thus need to model the correlation between different LIBOR forward rate.
\subsection{Software and systems}
Installed on PC : TortoiseSVN, tex-live, texstudio, nodepadd++, Visual Studio Express 2012, cmake, boost\_1\_55\_0 (self full built), QuantLib-1.4, BOUML, 7-zip, GLE, GSview, grep (GNU Win32). 
\paragraph{Bloomberg terminal} is available at Lunalogic.
\begin{itemize}	
	\item user can create a new account on the terminal in order to personalize
	\item user can load data into Excel sheet after installing a specific bloomberg tool for Excel. 
	\item Bloomberg University (BU) : contains all general informations
	\item Online Training : give a small videos for tutorials.
	\item Help-Help : hotline help
	\item Every Bloomberg users are connected and can talk together on the chat.
\end{itemize}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
\newpage
%\printnomenclature % % % % % % % % % % %
\bibliographystyle{siam}
\bibliography{intern_lunalogic.bib}
\end{document}
